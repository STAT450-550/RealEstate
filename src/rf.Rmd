---
title: "random forest"
output: github_document
---

```{r}
suppressPackageStartupMessages(library(randomForest))
suppressPackageStartupMessages(library(tidyverse))
```

```{r}
dat <- readr::read_delim("test_train_data.txt", delim = ",", col_types = "ciccdddddc")
dat$municipality <- as.factor(dat$municipality)
dat <- dat %>% 
  group_by(PIC) %>% 
  mutate(next.assess = lead(total.assessment, order_by = year)) %>%
  arrange(PIC) %>% 
  group_by(municipality, year) %>% 
  mutate(n.prop = n()) %>% 
  arrange(desc(n.prop)) %>% 
  distinct(municipality, .keep_all = T) 

train1 <- dat %>%  filter(test.train == "train" & tax.class == "01") 
test1 <- dat %>%  filter(test.train == "test" & tax.class == "01")
train5 <- dat %>%  filter(test.train == "train" & tax.class == "05")
test5 <- dat %>%  filter(test.train == "test" & tax.class == "05")
train6 <- dat %>%  filter(test.train == "train" & tax.class == "06")
test6 <- dat %>%  filter(test.train == "test" & tax.class == "06")
```

```{r}
rf1.mill <- randomForest(
  mill.rate ~ tax + municipality + total.assessment + year,
  data=na.omit(train1)
)
```




